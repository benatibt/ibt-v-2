/* **********************************************************************
   IBT THEME CSS
   Structural helpers for things that don’t fit in theme.json or templates
   ********************************************************************** */

/* ---------INDEX ----------
   1. Typography
   2. Buttons & Links
   3. Header, Nav & Footer
   4. Layout / Spacing
   5. Utilities
   6. States & Media
   7. Dev Sandbox
   ------------------------ */


/* ======================================================================
   1. TYPOGRAPHY
   Heading levels, visited links
   ====================================================================== */

/* Headings (per-level until WP adds theme.json support) */
h1 {font-size: var(--wp--preset--font-size--xxxl); font-weight: 700 ; padding-top: var(--wp--preset--spacing--xl) ; padding-bottom: var(--wp--preset--spacing--s);}
h2 {font-size: var(--wp--preset--font-size--xxl); font-weight: 600 ; padding-top: var(--wp--preset--spacing--l) ;}
h3 {font-size: var(--wp--preset--font-size--xl); font-weight: 600 ; padding-top: var(--wp--preset--spacing--m) ;}
h4 {font-size: var(--wp--preset--font-size--l); font-weight: 600 ; padding-top: var(--wp--preset--spacing--m) ;}
h5 {font-size: var(--wp--preset--font-size--m); font-weight: 600 ; padding-top: var(--wp--preset--spacing--s) ;}
h6 {font-size: var(--wp--preset--font-size--m); font-weight: 450 ; padding-top: var(--wp--preset--spacing--s) ;}

/* Visited links in body text */
:where(p, li, .rich-text) a:visited {color: var(--wp--custom--color--color-text-emphasis-primary-visited);}


/* ======================================================================
   2. BUTTONS & LINKS
   Variants, hover/focus states, global link effects
   ======================================================================
   2.1 - Buttons
   2.2 - Links */

/* ------------------------- 2.1 - Buttons ------------------------------ */

/* Button variants (that can not be styled in json) */
.wp-block-button.is-style-buy-solid .wp-block-button__link {
  background-color: var(--wp--custom--color--color-secondary);
  color: #FFF;
  border: 2px solid var(--wp--custom--color--color-secondary);
}

.wp-block-button.is-style-buy-outline .wp-block-button__link {
  background-color: transparent;
  color: var(--wp--custom--color--color-secondary);
  border: 2px solid var(--wp--custom--color--color-secondary);
}

/* Shared button behaviour */
.wp-block-button__link {transition: transform 0.15s ease, background-color 0.15s ease, border-color 0.15s ease;}
.wp-block-button__link:hover {transform: translateY(-1px);}
.wp-block-button__link:focus-visible {outline: 2px solid var(--wp--custom--color--color-primary); outline-offset: 2px;}

/* Button hover states by variant */
.wp-block-button:not(.is-style-outline):not(.is-style-buy-solid):not(.is-style-buy-outline) .wp-block-button__link:hover {
  background-color: var(--wp--custom--color--color-primary-hover);
  border-color: var(--wp--custom--color--color-primary-hover);
}
.wp-block-button.is-style-outline .wp-block-button__link:hover {
  color: var(--wp--custom--color--color-primary-hover);
  border-color: var(--wp--custom--color--color-primary-hover);
}
.wp-block-button.is-style-buy-solid .wp-block-button__link:hover {
  background-color: var(--wp--custom--color--color-secondary-hover);
  border-color: var(--wp--custom--color--color-secondary-hover);
}
.wp-block-button.is-style-buy-outline .wp-block-button__link:hover {
  color: var(--wp--custom--color--color-secondary-hover);
  border-color: var(--wp--custom--color--color-secondary-hover);
}

/* ------------------------- 2.2 - Links ------------------------------ */
 
/* Link hover and focus-visible effects */
:where(a[href]):not(.wp-element-button):not(.wp-block-button__link):not(.ibt-header-nav a):hover,
.wp-block-navigation:not(.ibt-header-nav) a:hover {
  text-decoration: underline;
  color: var(--wp--custom--color--color-primary-hover);
  text-decoration-thickness: 2px;
  text-underline-offset: 0.25em;
}
:where(a[href]):not(.wp-element-button):not(.wp-block-button__link):not(.ibt-header-nav a):focus-visible,
.wp-block-navigation:not(.ibt-header-nav) a:focus-visible {
  outline: 2px solid var(--wp--custom--color--color-primary);
  outline-offset: 2px;
}


/* ======================================================================
   3. HEADER, NAV & FOOTER
   Sticky, inner width, responsive swaps, woo icons, search, nav colours
   ====================================================================== */


   /* 6b. Give different styling treatement to navigations with css tag ibt-header-pages 
      for header links                                                                */

/* Add transparent box as default to avoid layout shift */      
.ibt-header-nav .wp-block-navigation-item__content,
.ibt-header-nav .wp-block-navigation__responsive-container-close {
  border: 1.5px solid transparent;
  border-radius: 6px;
  padding: 0.25rem 0.5rem; /* safe: your mobile overlay later sets bigger padding */
  transition: border-color 0.2s ease, color 0.2s ease;
}

.ibt-header-nav .wp-block-navigation-item__content:hover,
.ibt-header-nav .wp-block-navigation-item__content:focus-visible,
.ibt-header-nav .wp-block-navigation__responsive-container-close:hover,
.ibt-header-nav .wp-block-navigation__responsive-container-close:focus-visible {
  color: var(--wp--custom--color--color-primary-hover);
  border-color: currentColor;
}

/* 6c. Header utility icons (Search, Account, Cart unified)
   Wrapper provides stable box + styling.
   Inner <a>/<button> fills wrapper.
   Tap target: 44px content + 2×2px border = 48px (WCAG). */

/* Wrapper baseline */
.ibt-header-wooicons {
  width: 44px;
  height: 44px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: var(--wp--preset--color--emphasis-primary);
  border: 2px solid transparent; /* prevents layout shift */
  border-radius: 6px;
  transition: color 0.2s ease, border-color 0.2s ease;
  cursor: pointer;
}

/* Reset child control (<a> or <button>) to inherit */
.ibt-header-wooicons > a,
.ibt-header-wooicons > button {
  all: unset;
  width: 100%;
  height: 100%;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: inherit;
  border-radius: inherit;
  cursor: pointer;
}

/* SVGs follow currentColor */
.ibt-header-wooicons svg {
  width: 24px;
  height: 24px;
  display: block;
  pointer-events: none;
}

/* Hover + focus-visible states */
.ibt-header-wooicons:hover,
.ibt-header-wooicons:focus-within {
  color: var(--wp--custom--color--color-primary-hover);
  border-color: var(--wp--custom--color--color-primary-hover);
}

/* 8. Constrain header wide width with std root padding. Not possible in template  */
.ibt-header-inner {
  box-sizing: border-box;
  width: 100%;
  max-width: var(--wp--style--global--wide-size);
  margin-inline: auto;
  padding-inline: var(--wp--style--root--padding-left);
}

/* 9. Make header sticky for modern browsers. May not work without :has() support. */

/* 9a. Calculate sticky header offset for any WP admin bar */
:root { --ibt-adminbar-offset: 0px; }
.admin-bar { --ibt-adminbar-offset: 32px; }
@media (max-width: 782px) {
  .admin-bar { --ibt-adminbar-offset: 46px; }
}

/* 9b. Make the header sticky with the calculated offset */
.ibt-sticky,
.wp-block-template-part:has(> .ibt-sticky) {
  position: sticky;
  top: var(--ibt-adminbar-offset);
  z-index: 50; /* header sits above content */
}

/* 9c. If the template-part wrapper is also sticky, keep it just behind the header */
.wp-block-template-part:has(> .ibt-sticky) { z-index: 49; }


/* ======= 10. Responsive header behaviour ========== */

/* 10a. ---------- Defaults: tall & wide viewports ---------- */
/* Show desktop title/nav, hide mobile equivalents */
.ibt-title--desktop { display: block; }
.ibt-title--mobile  { display: none; }
.ibt-nav-dual .ibt-nav-desktop { display: block; }
.ibt-nav-dual .ibt-nav-mobile  { display: none; }

/* Harden desktop nav to stay horizontal whenever it’s visible */
.ibt-nav-dual .ibt-nav-desktop .wp-block-navigation__container {
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  align-items: center;
}

/* Row 2 forced right on wide screens */
@media (min-width: 781px) {
  .ibt-nav-dual.is-layout-flex {
    justify-content: flex-end;
  }
}



/* 10e. ---------- Header search behaviour ---------- */

/* Base state: search field hidden */
.ibt-search-field {
  display: none;
}

/* Ensure search icons are correct size for tap target */
.ibt-icons > * {
  min-width: 49px;
  min-height: 49px;
}

/* Normalise desktop site title to match icon height */
.ibt-title--desktop {
  line-height: 49px;
  height: 49px;
}

/* 10f. --------- Search Button ------------ */

/* Reset the HTML block wrapper margins/padding */
.ibt-search-button-wrapper {
  margin: 0;
  padding: 0;
  width: auto;
  display: inline-flex;
}

/* Style the toggle button itself */
.ibt-search-toggle {
  background: none;
  border: none;
  padding: 0;
  margin: 0;
  width: 49px;
  height: 49px;
  display: flex;
  align-items: center;
  justify-content: center;
}
/* 10g. ----------------- Search box ------------------- 
   Setup, style and adapt search box for different 
   header sizes.                                       */

/* Wrapper container */
.ibt-search--open .ibt-search-field {
  display: grid;
  align-items: center; /* centers the input vertically */
  height: var(--wp--custom--search--height); /* 48px */
  width: 280px; /* comfortable max, adapts for smaller screens */
}

/* Input is the visual box */
.ibt-search--open .ibt-search-field input[type="search"] {
  width: 100%;
  min-width: 0;
  box-sizing: border-box; /* keep sizing predictable */
  padding: var(--wp--custom--search--padding--top)
           var(--wp--custom--search--padding--right)
           var(--wp--custom--search--padding--bottom)
           var(--wp--custom--search--padding--left);
  border: 2px solid var(--wp--custom--color--color-header-border);
  border-radius: var(--wp--custom--search--border--radius);
  background: #fff;
  font-size: var(--wp--preset--font-size--s);
  line-height: 1.4;
}

/* Remove default outline on focus. Appearance of input box
   is already very strong focus indicator. */
.ibt-search--open .ibt-search-field input[type="search"]:focus-visible {
  outline: none;
}

/* Discrete widths by breakpoint for header adaption
   when search input is displayed  */

/* Stage 1: Medium range hide desktop site title when
   search is open. Below 780px there is no desktop site title 
   and justify right, default is space between. */
@media (max-width: 900px) and (min-width: 780px) {
  .ibt-search--open .ibt-title--desktop {display: none;} 
  .ibt-search--open .ibt-row1.is-layout-flex {justify-content: flex-end;}
}

/* DEV - May be reduntant, test mobile search spacing with this section disabled */
@media (max-width: 780px) {
  /* Mobile nav overlay — ensure padding + vertical stacking */
  .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation__responsive-container-content {
    padding: var(--wp--preset--spacing--l); /* breathing room inside drawer */
  }
  .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation__responsive-container-content > .wp-block-navigation__container {
    display: flex; flex-direction: column; /* force column layout in drawer */
  }
}

/* Stage 2: Narrow screens - shrink search input */
@media (max-width: 560px) {
  .ibt-search--open .ibt-search-field {width: 140px;}
}

/* Stage 3: Very narrow screens — hide Woo account + cart
            when search is open to make space for it. */
@media (max-width: 410px) {
  .ibt-search--open .ibt-icons [data-block-name="woocommerce/customer-account"],
  .ibt-search--open .ibt-icons [data-block-name="woocommerce/mini-cart"] {
    display: none;
  }
}




/* 11. === Global navigation backgrounds === */
/* Can not reliably be set from theme.json with WP6.8 and difficult
  in template with custom colors (not in palette)                   */

/* Desktop dropdown submenus */
.wp-block-navigation__submenu-container {
  background-color: var(--wp--custom--color--color-header-bg) !important;
}

/* Mobile overlay drawer (container + dialog) */
.wp-block-navigation__responsive-container,
.wp-block-navigation__responsive-dialog {
  background-color: var(--wp--custom--color--color-header-bg) !important;
}



/* ======================================================================
   4. LAYOUT / SPACING
   Root padding overrides, group/wide constraints
   ====================================================================== */

/* Strip default WP global padding from all Group blocks, except root-level and
   those marked with .ibt-outer-wrap. Prevents double-padding inside nested groups. */
:root :where(.wp-block-group):not(.has-global-padding):not(.ibt-outer-wrap) {padding-left: 0; padding-right: 0;}



/* ======================================================================
   5. UTILITIES
   SR-only, status colours, notices, dev/test helpers
   ====================================================================== */

/* Prevent media (img/video/iframe/etc) overflowing */
img, video, iframe, embed, object { max-width: 100%; height: auto; display: block;}

/* Anchor scroll offset to prevent in-page targets hiding behind sticky header */
h1[id], h2[id], h3[id], h4[id], h5[id], h6[id] {scroll-margin-top: 102px;}

/* Screen-reader only text */
.screen-reader-text {
  position: absolute !important;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip-path: inset(50%);
  white-space: nowrap;
  border: 0;
}

/* Editor-only: force all nav/title variants visible in Site Editor
   (keeps blocks selectable while editing) */
.editor-styles-wrapper .ibt-title--desktop,
.editor-styles-wrapper .ibt-title--mobile,
.editor-styles-wrapper .ibt-nav-dual .ibt-nav-desktop,
.editor-styles-wrapper .ibt-nav-dual .ibt-nav-mobile {
  display: block !important;
}



/* ======================================================================
   6. STATES & MEDIA
   Breakpoints, reduced motion, print
   ====================================================================== */

/* 6.1 - Header layout breakpoints
   6.2 - Print safeguards & Reduced Motion */

/* ---------------------- 6.1 Header layout breakpoints ---------------- */

/* ---- Default is narrow desktop / wide tablet ---- */

/* ---- Narrow screens ---- */
@media (max-width: 780px) {

  /* -- Header adaptation for narrow viewport -- */
  .ibt-title--desktop { display: none; }   /* Swap site titles */
  .ibt-title--mobile  { display: block; }
  .ibt-nav-dual .ibt-nav-desktop { display: none; } /* Swap navs */
  .ibt-nav-dual .ibt-nav-mobile  { display: block; }
  .ibt-row1.is-layout-flex { justify-content: flex-end; }   /* Row 1 right */
  .ibt-nav-dual.is-layout-flex { justify-content: space-between; } /* Reset Row 2 spacing */
  .ibt-header-inner > .wp-block-column:first-child { flex-basis: 70px; max-width: 70px; }  /* Reduce logo column width */
  
  /* -- Style mobile menu -- */

  /* Force submenu collapsed */
  .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation__submenu-container { display: none; }
  /* NOTE: Closed submenus remain in the keyboard tab order (edge case).
     Robust fix would need JS (e.g. toggle `inert` on the submenu when aria-expanded="false"). */

  /* show submenu when toggle is open (UL marked .is-open or aria-expanded=true on toggle) */
  .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation__submenu-container.is-open,
  .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation-submenu__toggle[aria-expanded="true"]
    + .wp-block-navigation__submenu-container,
  .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation-submenu__toggle[aria-expanded="true"]
    ~ .wp-block-navigation__submenu-container {
    display: flex;
    flex-direction: column;
    padding-left: var(--wp--preset--spacing--l);
  }

 /* Set AAA compliant tap target on mobile main menu */
  .ibt-header-nav nav.wp-block-navigation
    .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation__container > .wp-block-navigation-item > .wp-block-navigation-item__content,
  .ibt-header-nav nav.wp-block-navigation
    .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation__container > .wp-block-navigation-item > .wp-block-navigation-submenu__toggle,
  /* Generic overlay path (if wrapper class differs) */
  .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation__container > .wp-block-navigation-item > .wp-block-navigation-item__content,
  .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation__container > .wp-block-navigation-item > .wp-block-navigation-submenu__toggle {
    display: block; padding-block: var(--wp--preset--spacing--xs); padding-inline: var(--wp--preset--spacing--m);
  }

  /* Set AAA compliant tap target on mobile submenu */
  .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation__submenu-container > .wp-block-navigation-item > .wp-block-navigation-item__content,
  .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation__submenu-container > .wp-block-navigation-item > .wp-block-navigation-submenu__toggle {
    display: block; padding-block: var(--wp--preset--spacing--xs); padding-inline: var(--wp--preset--spacing--m);
  }

  /* Set AAA compliant tap target on mobile menu close button */
  .wp-block-navigation__responsive-container.is-menu-open
    .wp-block-navigation__responsive-container-close {
    min-width: 44px;
    min-height: 44px;
    padding: var(--wp--preset--spacing--s) var(--wp--preset--spacing--s);
  }  
} /* end ≤ 780px */

/* ---- Large width >1000px ---- */
@media (min-width: 1000px) {
  /* Larger font size for header navigation items */
  .ibt-header .ibt-nav-dual .ibt-nav-desktop .wp-block-navigation__container { font-size: var(--wp--preset--font-size--l); }
  /* Increase block gap between nav items */
  .ibt-header .ibt-nav-dual .ibt-nav-desktop { gap: var(--wp--preset--spacing--xs); }
}

/* ---- Short viewport height ≤600px ---- */
@media (max-height: 600px) {
  /* Disable sticky header entirely */
  .ibt-sticky, .wp-block-template-part:has(> .ibt-sticky) { position: static !important; top: auto !important;  }
}

/* ---------------------- 6.2 Print Safeguards & Reduced Motion ---------------- */

/* --- Print safeguards - Avoid print problems from sticky header and double navigation --- */
@media print {
  /* Show desktop navigation and hide mobile navigation */
  .ibt-nav-dual .ibt-nav-desktop { display: block !important; }
  .ibt-nav-dual .ibt-nav-mobile  { display: none !important; }

  /* Disable sticky positioning for header and its template wrapper */
  .ibt-sticky,
  .wp-block-template-part:has(> .ibt-sticky) {
    position: static !important;
    top: auto !important;
  }
}

/* --- Reduced motion — global safety net ---
   If reduced motion selected by user, disable non-essential animations,
   transitions, and smooth scrolling. */
@media (prefers-reduced-motion: reduce) {
  /* Disable smooth scrolling if set anywhere */
  :root, html:focus-within { scroll-behavior: auto !important; }
  /* Disable animations/transitions across the UI */
  *, *::before, *::after {
      animation: none !important;
      transition: none !important;
  }
}


/* ======================================================================
   7. DEV & TEST
   Work in progress code. To be moved when complete.
   ====================================================================== */


/* **********************************************************************
   END IBT THEME CSS
   ********************************************************************** */