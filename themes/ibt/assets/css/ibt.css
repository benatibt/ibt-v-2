/* **********************************************************************
   IBT THEME CSS
   Structural helpers for things that don’t fit in theme.json or templates
   ********************************************************************** */

/* ---------INDEX ----------
   0. Theme documentation
   1. Typography & Base styles
   2. Buttons & Links - Common
   3. Header, Nav & Footer
   4. Layout / Spacing
   5. Utilities
   6. States & Media
   7. Dev Sandbox
   ------------------------ */

/* =====================================================================
             0 - Theme documentation and conventions
  =====================================================================
  
  Purpose:
  Keep all theme-level CSS predictable, token-driven, and accessible.
  Document design here in just enough detail for future maintenance
  without the overhead of separate documents. 

   
--------- 0.1 - TOKEN & NAMING SYSTEM --------
   
WordPress tokens
  --wp--* ........................ Core WP presets
  .editor-styles-wrapper ......... Set formats specifically for site editor.

IBT custom tokens
  --color-* ...................... Semantic colour tokens (palette-agnostic)
  --ibt-adminbar-offset .......... Offset for WP admin bar
  --wp--custom--color--* ......... Private palette (as -color but not exposed to editor)
  --spacing-* .................... Spacing scale (rem-based or clamp)
  --transition-* ................. Motion timing (base, fast, slow) for easy tuning

--------- 0.2 - CLASS NAMING ------------

ROOT PADDING
  .ibt-rootp-apply ................ Add to outer groups to apply root padding.
  .ibt-rootp-bg-exempt ............ Background is not constrained with content box
HEADER
  .ibt-header ..................... Main header wrapper element.
  .ibt-header-icons ............... Wrapper for all header icon buttons.
  .ibt-header-inner ............... Constrains header inner width and applies root padding.
  .ibt-header-nav ................. Common styling for all navigation instances.
  .ibt-header-nav-desktop ......... Desktop navigation instance.
  .ibt-header-nav-dual ............ Wrapper combining both desktop and mobile nav blocks for breakpoint toggling.
  .ibt-header-nav-mobile .......... Mobile navigation instance.
  .ibt-header-row1 ................ First header row (utility row).
  .ibt-header-row2 ................ Second header row (navigation row).
  .ibt-header-search-button-wrap .. Search button wrapper (for consistent sizing with Woo icons).
  .ibt-header-search-field ........ Container for the search input.
  .ibt-header-search-toggle ....... Icon-only button that toggles search visibility.
  .ibt-header-search.is-open ...... State class applied to header when search field is active/open.
  .ibt-header-sticky .............. Makes the header sticky beneath the WP admin bar.
  .ibt-header-title-desktop ....... Row 1 site title — visible on desktop.
  .ibt-header-title-mobile ........ Row 2 site title — visible on mobile.
  .ibt-header-wooicons ............ Wrapper for WooCommerce header icons.

PREFOOTER
  .ibt-prefooter-card ............. Inline-block wrapper for pre-footer call-to-action card.
  .ibt-prefooter-inner ............ Centers pre-footer inner group content horizontally.

------------- 0.3 - STYLE PRINCIPLES ----------------------

• Header/footer constrained to 80 rem inner width (review later)
• Root padding uses clamp().
• Colour-agnostic design: only #000 / #fff should appear literal.
• All motion ease times use transition tokens.
• Tokens are mostly set in theme.json, reasons for exceptions in comments. This includes
  custom tokens --wp--custom--*
• :has() used for styling elements but not for critical functionality. (Support for v. old browsers.)  
• Typography and spacing use tokens or clamp() at larger sizes for responsive fluid scaling.
• Accessibility: AAA general target but safe AA acceptable if really needed.
• Basic keyboard nav tests during dev, full a11y checks before release


------------ 0.4 - COMMENT CONVENTION -------------------------

Each section comment should include:
  WHY – design intent for all sections / blocks (always)
  WHAT IT DOES – plain English for complex syntax (when needed)
  HOW TO MAINTAIN – notes for future (when needed)

Example: (+ == *)
  /+ Scale nav text to suit container width. 1cqw = 1% of nav container width.
    Note - Adjust slope if wrapping occurs in header desktop nav .+/
  font-size: clamp(1rem, 1cqw + 0.9rem, 1.25rem);


/* ======================================================================
   1. TYPOGRAPHY & BASE STYLES
   Basic styling that doesn't work in json yet
   ====================================================================== */

/* Define variables for use in all transitions. Not in theme.json because
   it doesn't support transitions yet. */
:root {
  --transition-base: 0.2s ease-in-out; /* Default */
  --transition-fast: 0.15s ease-out;   /* hover & micro-lift effects */
  --transition-slow: 0.3s ease;        /* larger fades / layout shifts */
}

/* Headings (per-level until WP adds theme.json support) */
h1 {font-size: var(--wp--preset--font-size--xxxl); font-weight: 700 ; padding-top: var(--wp--preset--spacing--xl) ; padding-bottom: var(--wp--preset--spacing--s);}
h2 {font-size: var(--wp--preset--font-size--xxl); font-weight: 600 ; padding-top: var(--wp--preset--spacing--l) ;}
h3 {font-size: var(--wp--preset--font-size--xl); font-weight: 600 ; padding-top: var(--wp--preset--spacing--m) ;}
h4 {font-size: var(--wp--preset--font-size--l); font-weight: 600 ; padding-top: var(--wp--preset--spacing--m) ;}
h5 {font-size: var(--wp--preset--font-size--m); font-weight: 600 ; padding-top: var(--wp--preset--spacing--s) ;}
h6 {font-size: var(--wp--preset--font-size--m); font-weight: 450 ; padding-top: var(--wp--preset--spacing--s) ;}

/* Visited links in body text. Visited link styling not supported in json yet. */
:where(p, li, .rich-text) a:visited {color: var(--wp--custom--color--color-text-emphasis-primary-visited);}

/* Provide theme style for <hr>, partially supported in json but doing all in one place is cleaner. */
hr,
.wp-block-separator {
  border: none;
  border-top: 1px solid var(--wp--custom--color--border-primary);
  margin-block: var(--wp--preset--spacing--m);
}


/* ======================================================================
   2. BUTTONS & LINKS
   Variants, hover/focus states, global link effects
   ======================================================================
   2.1 - Buttons
   2.2 - Links */

/* ------------------------- 2.1 - Buttons ------------------------------ */

/* Button variants (that can't be styled in json) */
.wp-block-button.is-style-buy-solid .wp-block-button__link {
  background-color: var(--wp--custom--color--color-secondary);
  color: #fff;
  border: 2px solid var(--wp--custom--color--color-secondary);
}

.wp-block-button.is-style-buy-outline .wp-block-button__link {
  background-color: transparent;
  color: var(--wp--custom--color--color-secondary);
  border: 2px solid var(--wp--custom--color--color-secondary);
}

/* Shared button behaviour */
.wp-block-button__link {transition: 
  color var(--transition-base),
  background-color var(--transition-base),
  border-color var(--transition-base),
  transform var(--transition-fast);
}
.wp-block-button__link:hover {transform: translateY(-1px);}
.wp-block-button__link:focus-visible {outline: 2px solid var(--wp--custom--color--color-primary); outline-offset: 2px;}

/* Button hover states by variant */
.wp-block-button:not(.is-style-outline):not(.is-style-buy-solid):not(.is-style-buy-outline) .wp-block-button__link:hover {
  background-color: var(--wp--custom--color--color-primary-hover);
  border-color: var(--wp--custom--color--color-primary-hover);
}
.wp-block-button.is-style-outline .wp-block-button__link:hover {
  color: var(--wp--custom--color--color-primary-hover);
  border-color: var(--wp--custom--color--color-primary-hover);
}
.wp-block-button.is-style-buy-solid .wp-block-button__link:hover {
  background-color: var(--wp--custom--color--color-secondary-hover);
  border-color: var(--wp--custom--color--color-secondary-hover);
}
.wp-block-button.is-style-buy-outline .wp-block-button__link:hover {
  color: var(--wp--custom--color--color-secondary-hover);
  border-color: var(--wp--custom--color--color-secondary-hover);
}

/* ------------------------- 2.2 - Links ------------------------------ */
 
/* Link hover and focus-visible effects */
:where(a[href]):not(.wp-element-button):not(.wp-block-button__link):not(.ibt-header-nav a) {
  transition:
    color var(--transition-base),
    text-decoration-color var(--transition-base);
}

:where(a[href]):not(.wp-element-button):not(.wp-block-button__link):not(.ibt-header-nav a):hover,
.wp-block-navigation:not(.ibt-header-nav) a:hover {
  text-decoration: underline;
  color: var(--wp--custom--color--color-primary-hover);
  text-decoration-thickness: 2px;
  text-underline-offset: 0.25em;
}

:where(a[href]):not(.wp-element-button):not(.wp-block-button__link):not(.ibt-header-nav a):focus-visible,
.wp-block-navigation:not(.ibt-header-nav) a:focus-visible {
  outline: 2px solid var(--wp--custom--color--color-primary);
  outline-offset: 2px;
}


/* ======================================================================
   3. HEADER, NAV & FOOTER
   Sticky, navigation, utility icons,  search, footer
   ====================================================================== */

/* ----------------------------------------------------------------------
   The IBT header contains *TWO SEPARATE* Navigation block instances to 
   allow breakpoint control and avoid limitations of WP’s overlay toggle.
   ----------------------------------------------------------------------*/

/* ----------------------------------------------------------------------
   3.1 – Sticky Header
   ---------------------------------------------------------------------- */
/* Keep header stuck to top with admin-bar offset for logged-in users.
   Note – Adjust --ibt-adminbar-offset if WordPress changes bar height. */

:root { --ibt-adminbar-offset: 0px; }
.admin-bar { --ibt-adminbar-offset: 32px; }

@media (max-width: 782px) {
  .admin-bar { --ibt-adminbar-offset: 46px; }
}

.ibt-header-sticky,
.wp-block-template-part:has(> .ibt-header-sticky) {
  position: sticky;
  top: var(--ibt-adminbar-offset);
  z-index: 50;
}

.wp-block-template-part:has(> .ibt-header-sticky) { z-index: 49; }

/* ---- Responsive: short viewport height ----
   Disable sticky header on small viewports to prevent content loss. */
@media (max-height: 600px) {
  .ibt-header-sticky,
  .wp-block-template-part:has(> .ibt-header-sticky) {
    position: static !important;
    top: auto !important;
  }
}


/* ----------------------------------------------------------------------
   3.2 – Header Styling
   ---------------------------------------------------------------------- */

/* ----- 3.2.A - Base container -----
   Handles header background, border, and general layout. */

/* Provide base styling and layout for the header container. */
.ibt-header {
  background-color: var(--wp--custom--color--color-header-bg);
  color: var(--wp--preset--color--emphasis-primary);
  border: none;
}

/* Center header content and constrain width to wide container. */
.ibt-header-inner {
  box-sizing: border-box;
  width: 100%;
  max-width: var(--wp--style--global--wide-size);
  margin-inline: auto;
  padding-block: 0;
}


/* ----- 3.2.B - Logo and column layout -----
   Manage logo column width, alignment and spacing. */

/* Fix logo column width (inline style override from block editor). */
.ibt-header-inner > .wp-block-column:first-child {
  flex-basis: 85px !important;
  max-width: 85px;
}

/* ----- 3.2.C - Utility icons ----- */
/* Style search, account and cart icons as consistent 44×44 px tap targets. */

.ibt-header-wooicons {
  width: 44px;
  height: 44px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: var(--wp--preset--color--emphasis-primary);
  border: 2px solid transparent;
  border-radius: 6px;
  transition: color var(--transition-base), border-color var(--transition-base);
  cursor: pointer;
  min-width: 49px;
  min-height: 49px;
}

.ibt-header-wooicons > a,
.ibt-header-wooicons > button {
  all: unset;
  width: 100%;
  height: 100%;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: inherit;
  border-radius: inherit;
  cursor: pointer;
}

.ibt-header-wooicons svg {
  width: 24px;
  height: 24px;
  display: block;
  pointer-events: none;
}

/* Change icon colour and border on hover or focus. 
.ibt-header-wooicons:hover,
.ibt-header-wooicons:focus-within {
  color: var(--wp--custom--color--color-primary-hover);
  border-color: var(--wp--custom--color--color-primary-hover);
}*/




/* ----------------------------------------------------------------------
   3.3 – Header Search
   ---------------------------------------------------------------------- */
/* Handle search toggle and field behaviour controlled by ibt-header.js. */

.ibt-header-search-field { display: none; }

.ibt-header-search-toggle {
  all: unset;
  width: 49px;
  height: 49px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

/* Show search field when header JS adds .is-open. */
.ibt-header-search.is-open .ibt-header-search-field {
  display: grid;
  align-items: center;
  height: var(--wp--custom--search--height);
  width: 280px;
}

.ibt-header-search.is-open .ibt-header-search-field input[type="search"] {
  width: 100%;
  box-sizing: border-box;
  padding: var(--wp--custom--search--padding--top)
           var(--wp--custom--search--padding--right)
           var(--wp--custom--search--padding--bottom)
           var(--wp--custom--search--padding--left);
  border: 2px solid var(--wp--custom--color--color-header-border);
  border-radius: var(--wp--custom--search--border--radius);
  background: #fff;
  font-size: var(--wp--preset--font-size--s);
  line-height: 1.4;
}

.ibt-header-search.is-open .ibt-header-search-field input[type="search"]:focus-visible {
  outline: none;
}

/* ---- Responsive: narrow screens (≤600 px) ----
   Shrink search box for smaller layouts. */
@media (max-width: 600px) {
  .ibt-header-search.is-open .ibt-header-search-field { width: 140px; }
}

/* ---- Responsive: very narrow screens (≤410 px) ----
   Hide account + cart icons to make space for open search. */
@media (max-width: 410px) {
  .ibt-header:has(.ibt-header-search.is-open)
    .ibt-header-icons [data-block-name="woocommerce/customer-account"],
  .ibt-header:has(.ibt-header-search.is-open)
    .ibt-header-icons [data-block-name="woocommerce/mini-cart"] {
    display: none;
  }
}


/* ----------------------------------------------------------------------
   3.4 – Desktop Navigation
   ---------------------------------------------------------------------- */

/* ----- 3.4.A Layout and tap targets -----
   Keep nav horizontal, evenly spaced, and AAA-compliant for touch. */

.ibt-header-nav-dual .ibt-header-nav-desktop .wp-block-navigation__container {
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  align-items: center;
}

.ibt-header-nav-desktop .wp-block-navigation__container
  .wp-block-navigation-item__content,
.ibt-header-nav-desktop .wp-block-navigation__submenu-container
  .wp-block-navigation-item__content {
  display: flex;
  align-items: center;
  line-height: 1.2;
  min-height: 48px; /* AAA baseline */
  padding-top: 0;
  padding-bottom: 0;
}

/* Equal horizontal padding for all clickable elements. */
.ibt-header-nav-desktop :is(
  a.wp-block-navigation-item__content,
  button.wp-block-navigation-item__content,
  button.wp-block-navigation-submenu__toggle,
  button.wp-block-navigation-item__content.wp-block-navigation-submenu__toggle
) {
  padding-left:  clamp(7px, 1.81vw - 7.1px, 20px);
  padding-right: clamp(7px, 1.81vw - 7.1px, 20px);
}

/* Compact gap between items (replaces blockGap in header.html). */
.ibt-header .ibt-header-nav-dual .ibt-header-nav-desktop {
  gap: 3px;
}

/* ----- 3.4.B Typography and scaling-----
   Adjust text size smoothly with viewport width. */

.ibt-header-nav-desktop .wp-block-navigation__container {
  font-size: clamp(17.6px, 0.4vw + 14.4px, 24px);
  line-height: 1.4;
  letter-spacing: 0.01em;
  font-weight: 600; /* semi-bold */
}

/* ----- 3.4.C Borders and default state -----
   Prepare for tab-index styling (3.4 d). */

.ibt-header-nav-desktop .wp-block-navigation-item__content {
  border: 2px solid transparent;
  border-radius: 6px 6px 0 0;
  border-bottom: none; /* tab illusion */
  background-color: var(--wp--custom--color--color-header-bg);
  transition: border-color var(--transition-base),
              color var(--transition-base),
              background-color var(--transition-base);
}

/* ----------------------------------------------------------------------
   3.4.C.1 – Card-index Tabs (Active & Ancestor states – functional test)
   Connects PHP-generated classes to visible tab colours.
   Note – replace strong colours with tokens after confirmation.
---------------------------------------------------------------------- */

/* ----------------------------------------------------------------------
   3.4.C.1 – Card-index Tabs (Test colours, wired to active/ancestor)
   Replace colours with theme tokens once verified.
---------------------------------------------------------------------- */

.ibt-header-nav-desktop {
  --color-header-tab-default: hotpink;  /* other */
  --color-header-tab-hover:   magenta;  /* hover */
  --color-header-tab-active:  white;    /* exact match */
  --color-header-tab-related: grey;     /* ancestor */
  --color-header-tab-border:  purple;
}

/* Default / Other */
.ibt-header-nav-desktop .wp-block-navigation-item__content {
  background-color: var(--color-header-tab-default);
  border-color: transparent;
  color: var(--wp--preset--color--emphasis-primary);
}

/* Active (exact page match) */
.ibt-header-nav-desktop .wp-block-navigation-item__content.wp-block-navigation-item--active {
  background-color: var(--color-header-tab-active);
  border-color: var(--color-header-tab-border);
  color: black;
}

/* Ancestor / Parent (section match) */
.ibt-header-nav-desktop .wp-block-navigation-item__content.wp-block-navigation-item--ancestor {
  background-color: var(--color-header-tab-related);
  border-color: var(--color-header-tab-border);
  color: black;
}

/* Hover / Focus (non-active) */
.ibt-header-nav-desktop
  .wp-block-navigation-item__content:not(.wp-block-navigation-item--active):hover,
.ibt-header-nav-desktop
  .wp-block-navigation-item__content:not(.wp-block-navigation-item--active):focus-visible {
  background-color: var(--color-header-tab-hover);
  border-color: var(--color-header-tab-border);
  color: black;
}





/* Uncomment once tab highlighting is ready:
.ibt-header-nav-desktop .wp-block-navigation-item__content:hover,
.ibt-header-nav-desktop .wp-block-navigation-item__content:focus-visible {
  color: var(--wp--custom--color--color-primary-hover);
  border-color: var(--wp--custom--color--color-primary-hover);
}
*/

/* ----- 3.4.D - Submenu containers -----
   Match header background for drop-downs. */
.ibt-header-nav-desktop .wp-block-navigation__submenu-container {
  background-color: var(--wp--custom--color--color-header-bg) !important;
  border-radius: 6px;
}

/* Remove automatic ▼ icon from desktop nav items to avoid styling problems.*/
.ibt-header-nav-desktop .wp-block-navigation__submenu-icon {
  display: none !important;
}

/* Default visibility — desktop nav active, mobile turned off */
.ibt-header-nav-dual .ibt-header-nav-desktop { display: block; }
.ibt-header-nav-dual .ibt-header-nav-mobile  { display: none; }


/* ----------------------------------------------------------------------
   3.5 – Mobile Navigation
   ---------------------------------------------------------------------- */

/* Collapse all submenus by default and only reveal those opened by WordPress. */
.ibt-header-nav-mobile .wp-block-navigation__responsive-container.is-menu-open
  .wp-block-navigation__submenu-container {
  display: none;
}

.ibt-header-nav-mobile .wp-block-navigation__submenu-container.is-open,
.ibt-header-nav-mobile .wp-block-navigation-submenu__toggle[aria-expanded="true"]
  + .wp-block-navigation__submenu-container,
.ibt-header-nav-mobile .wp-block-navigation-submenu__toggle[aria-expanded="true"]
  ~ .wp-block-navigation__submenu-container {
  display: block;
}

/* Add padding inside the mobile overlay when menu is open. */
.ibt-header-nav-mobile
  :is(.wp-block-navigation__responsive-container,
      .wp-block-navigation__responsive-dialog).is-menu-open
  .wp-block-navigation__responsive-container-content {
  padding: 1.5rem;
}

/* Add equal padding to all mobile menu items. */
.ibt-header-nav-mobile
  :is(a.wp-block-navigation-item__content,
      button.wp-block-navigation-submenu__toggle) {
  padding-left: 1rem !important;
  padding-right: 1rem !important;
}

/* Ensure open and close buttons meet AAA tap target and visual feedback. */
.ibt-header-nav-mobile
  :is(.wp-block-navigation__responsive-container-open,
      .wp-block-navigation__responsive-container-close) {
  min-width: 49px;
  min-height: 49px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: 2px solid transparent;
  border-radius: 6px;
  color: var(--wp--preset--color--emphasis-primary);
  cursor: pointer;
  transition: color var(--transition-base),
              border-color var(--transition-base);
}

/* Ensure mobile nav items meet AAA tap-target size and stay vertically centred. */
.ibt-header-nav-mobile
  :is(.wp-block-navigation__container a.wp-block-navigation-item__content,
      .wp-block-navigation__container button.wp-block-navigation-item__content,
      .wp-block-navigation__submenu-container a.wp-block-navigation-item__content,
      .wp-block-navigation__submenu-container button.wp-block-navigation-item__content) {
  min-height: 48px;
  display: flex;
  align-items: center;
}

/* Uncomment later when hover/focus tuning resumes:
.ibt-header-nav-mobile
  :is(.wp-block-navigation__responsive-container-open,
      .wp-block-navigation__responsive-container-close):hover,
.ibt-header-nav-mobile
  :is(.wp-block-navigation__responsive-container-open,
      .wp-block-navigation__responsive-container-close):focus-visible {
  color: var(--wp--custom--color--color-primary-hover);
  border-color: currentColor;
}
*/

/* Match overlay background to header background colour. */
.wp-block-navigation__responsive-container,
.wp-block-navigation__responsive-dialog {
  background-color: var(--wp--custom--color--color-header-bg) !important;
}

/* ---- Responsive: narrow screens (≤799 px) ----
   Swap desktop / mobile nav elements. */
@media (max-width: 799px) {
  .ibt-header-nav-dual .ibt-header-nav-desktop { display: none; }
  .ibt-header-nav-dual .ibt-header-nav-mobile  { display: block; }
}


/* ======================================================================
   4. LAYOUT / SPACING
   Root padding and group / wide constraints
   ====================================================================== */

/* ---------------------------------------------------------------------
   4.1 Root Padding System
  
   WordPress core "root-padding" is unpredictable, varies by context,
   and conflicts with nested Group block padding. This system replaces
   it with a single class-based model that applies theme-wide spacing
   in a predictable, token-driven way.

   How it works:
   • Resets all Group block padding to 0 using :where() for zero specificity.
     Removes most WP default padding (& any from theme.json) but editor padding survives.
   • Applies fluid root padding via theme.json token to any wrapper using .ibt-rootp-apply.
   • Ensures backgrounds stop cleanly at the content rail unless .alignfull is used.

   Notes:
   • Adjust the clamp() value in theme.json → layout.root-padding to change spacing globally.
   • Add .ibt-rootp-apply to any outer wrapper (e.g. <main>) to apply global rails.
   • Manual group padding is generally not required in editor but can be used if needed. */

/* Reset Group block padding (neutral base) */
:where(.wp-block-group) {
  padding: 0;
}

/* Apply theme root padding on outer wrappers */
.ibt-rootp-apply {
  padding-inline: var(--wp--custom--layout--root-padding);
}

/* Constrain inner groups to content rail unless .alignfull or .ibt-rootp-bg-exempt */
.ibt-rootp-apply > :not(.alignfull):not(.ibt-rootp-bg-exempt) {
  box-sizing: content-box;
}

/* ---------------------------------------------------------------------
    4.2 - SINGLE POST WITH SIDEBAR

single.html
   • One-article layout with optional right sidebar.
   • Sidebar (<aside>) lives inside second column (.ibt-sideb-sideb).
   • Sticky CTAs use .ibt-sideb-sticky (position: sticky; top: 50vh).
   • Mobile bar <aside.ibt-sideb-mobile> shown ≤50rem; desktop hidden.
   • Outer <main> uses .ibt-rootp-apply for global root padding. 
   
Purpose:
   Manage two-column post layouts with an optional sidebar and mobile CTA bar.

   Desktop (>60rem)
   • Two columns (5/8 content, 3/8 sidebar)
   • Equal-height columns via flex stretch
   • Sticky CTA (.ibt-sideb-sticky) ensures visible sidebar content
   • Mobile bottom bar (.ibt-sideb-mobile) hidden

   Mobile (≤60rem)
   • Sidebar hidden, bottom bar shown
   • Content column expands to full width

   Editor
   • Both sidebar and bottom bar visible for editing convenience */

   /* ******************************************************************
                DEV REQUIRED – Future Semantic Enhancement
  
   Once single.html and sidebar templates are stable:
   • Move HTML semantics (role="complementary", aria-label="Sidebar")
     into PHP via render_block filter.
   • Implement in theme /inc/semantics.php and include from functions.php.
   • Purpose: preserve <div> for Gutenberg editor compatibility while
     providing <aside>-equivalent semantics on front-end render only.
   ********************************************************************* */

/* Columns container (main + sidebar) */
.ibt-sideb-columns {
  display: flex;
  align-items: stretch;                           /* equal column heights */
  gap: var(--wp--preset--spacing--l);
  max-width: var(--wp--style--global--wide-size);
  margin-inline: auto;

  /* Ratio + guards (variable defs) */
  --_gap: var(--wp--preset--spacing--l);
  --_content-ratio: 0.625;                        /* 5/8 */
  --_sidebar-ratio: 0.375;                        /* 3/8 */
  --_content-max: var(--wp--custom--sideb--size-content, 50rem);
  --_content-min: 33rem;                          /* readable floor */
  --_sidebar-min: 20rem;                          /* usable product-card floor */
}


/* DEV */

/* Full-width background when the sidebar column has the exempt class */
.ibt-sideb-columns:has(> .ibt-sideb-sideb.ibt-rootp-bg-exempt) { position: relative; isolation: isolate; }

.ibt-sideb-columns:has(> .ibt-sideb-sideb.ibt-rootp-bg-exempt)::after {
  content:"";
  position:absolute; top:0; bottom:0;
  left: calc(var(--_content-ratio) * (100% - var(--_gap)) + var(--_gap));
  right: calc((100vw - 100%) * -1);
  background-color:#f6f6f6;
  z-index:-1;
}

.ibt-sideb-sideb.ibt-rootp-bg-exempt {
  border-left: 1px solid var(--wp--preset--color--border-dark, #999);
}

.ibt-sideb-sideb.ibt-rootp-bg-exempt { background: none; }

@media (max-width: 60rem) {
  .ibt-sideb-columns:has(> .ibt-sideb-sideb.ibt-rootp-bg-exempt)::after { display:none; }
}

/* END DEV */


/* Main content column (clamped by ratio + guards) */
.ibt-sideb-columns .ibt-sideb-content {
  flex: 0 0 clamp(
    var(--_content-min),
    calc(var(--_content-ratio) * (100% - var(--_gap))),
    var(--_content-max)
  ) !important;
  max-width: clamp(
    var(--_content-min),
    calc(var(--_content-ratio) * (100% - var(--_gap))),
    var(--_content-max)
  ) !important;
  display: flex;
  flex-direction: column;
}

/* Sidebar column (clamped by ratio + min)
   Flex layout keeps spacers and stacking natural. */
.ibt-sideb-sideb {
  flex: 1 1 clamp(
    var(--_sidebar-min),
    calc(var(--_sidebar-ratio) * (100% - var(--_gap))),
    calc(100% - var(--_content-min) - var(--_gap))
  );
  min-width: var(--_sidebar-min);
  padding-left: var(--wp--custom--layout--root-padding);
  display: flex;
  flex-direction: column;

  /* footer clearance */
  margin-bottom: var(--wp--preset--spacing--xl);
}

/* Sticky CTA: opt-in via .ibt-sideb-sticky */
.ibt-sideb-sideb .ibt-sideb-sticky {
  position: sticky;
  top: 50vh;                                      /* mid-viewport feel */
  align-self: flex-start;
}

/* Responsive - see 6.3

/* ======================================================================
   5. UTILITIES
   SR-only, status colours, notices, dev/test helpers
   ====================================================================== */

/* Prevent media (img/video/iframe/etc) overflowing */
img, video, iframe, embed, object { max-width: 100%; height: auto; display: block;}

/* Anchor scroll offset to prevent in-page targets hiding behind sticky header */
h1[id], h2[id], h3[id], h4[id], h5[id], h6[id] {scroll-margin-top: 102px;}

/* Screen-reader only text */
.screen-reader-text {
  position: absolute !important;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip-path: inset(50%);
  white-space: nowrap;
  border: 0;
}

/* Editor-only: force both nav variants visible in Site Editor
   (keeps blocks selectable while editing) */
.editor-styles-wrapper .ibt-header-nav-dual .ibt-header-nav-desktop,
.editor-styles-wrapper .ibt-header-nav-dual .ibt-header-nav-mobile {
  display: block !important;
}


/* ======================================================================
   6. STATES & MEDIA
   Breakpoints, reduced motion, print
   ====================================================================== */

/* DEV - HEADER RESPONSIVE STATES REMOVED TO BACKUP FILE */

/* ---------------------- 6.3 Responsive single post and sidebar (see 4.2) ----------------- */

/* Default desktop/tablet */
.ibt-sideb-mobile { display: none; }

/* Collapse to mobile layout */
@media (max-width: 60rem) {
  .ibt-sideb-sideb { display: none; }  /* hide sidebar */
  .ibt-sideb-mobile { display: block; } /* show mobile bottom bar */

  /* Content goes full width */
  .ibt-sideb-columns .ibt-sideb-content {
    flex: 1 1 100% !important;
    max-width: 100% !important;
  }
}

/* Site Editor - Show both so they can be editied. */
.editor-styles-wrapper .ibt-sideb-sideb,
.editor-styles-wrapper .ibt-sideb-mobile {
  display: block !important;
}

/* ---------------------- 6.4 Print Safeguards ------------------ */

/* --- Prevent print layout issues (sticky header, double nav) --- */
@media print {
  /* Show desktop navigation and hide mobile navigation */
  .ibt-header-nav-dual .ibt-header-nav-desktop { display: block !important; }
  .ibt-header-nav-dual .ibt-header-nav-mobile  { display: none !important; }

  /* Disable sticky positioning for header and its template wrapper */
  .ibt-header-sticky,
  .wp-block-template-part:has(> .ibt-header-sticky) {
    position: static !important;
    top: auto !important;
  }
}

/* ---------------------- 6.5 Reduced Motion ------------------ */

/* --- Implement user reduced-motion preference (WCAG compliance) --- */
@media (prefers-reduced-motion: reduce) {
  /* Disable smooth scrolling if set anywhere */
  :root, html:focus-within { scroll-behavior: auto !important; }
  /* Disable animations/transitions across the UI */
  *, *::before, *::after {
      animation: none !important;
      transition: none !important;
  }
}


/* ======================================================================
   7. DEV – WIP CODE
   ====================================================================== */



/* **********************************************************************
   END IBT THEME CSS
   ********************************************************************** */